<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login - Controle Financeiro</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f4f6f9;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.login-box {
    background: white;
    padding: 30px;
    border-radius: 10px;
    width: 320px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

input {
    width: 100%;
    padding: 10px;
    margin: 8px 0;
    border-radius: 5px;
    border: 1px solid #ccc;
}

button {
    width: 100%;
    padding: 10px;
    margin-top: 8px;
    border: none;
    border-radius: 5px;
    color: white;
    cursor: pointer;
}

.btn-login { background: #007bff; }
.btn-register { background: #28a745; }

.message {
    margin-top: 10px;
    text-align: center;
    font-size: 14px;
    min-height: 20px;
}
</style>
</head>

<body>

<div class="login-box">
    <h2>Acesso ao Sistema</h2>

    <input type="email" id="email" placeholder="Digite seu email">
    <input type="password" id="password" placeholder="Digite sua senha">

    <button class="btn-login" id="loginBtn">Entrar</button>
    <button class="btn-register" id="registerBtn">Criar Conta</button>

    <div class="message" id="message"></div>
</div>

<script>

// =============================
// CONFIGURAÇÃO SUPABASE
// =============================

const supabaseUrl = "https://rsbdxeyplwbaxvrublgr.supabase.co";
const supabaseKey = "sb_publishable_WgNRWWeTsCgQ1nUjG9QEUA_ixy3O2Ts";

const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

// =============================
// REGISTRO
// =============================

document.getElementById("registerBtn").addEventListener("click", async () => {

    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    const message = document.getElementById("message");

    message.innerText = "Processando...";
    message.style.color = "black";

    const { error } = await supabase.auth.signUp({
        email: email,
        password: password,
    });

    if (error) {
        message.innerText = error.message;
        message.style.color = "red";
    } else {
        message.innerText = "Conta criada! Verifique seu email.";
        message.style.color = "green";
    }
});

// =============================
// LOGIN
// =============================

document.getElementById("loginBtn").addEventListener("click", async () => {

    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    const message = document.getElementById("message");

    message.innerText = "Verificando...";
    message.style.color = "black";

    const { error } = await supabase.auth.signInWithPassword({
        email: email,
        password: password,
    });

    if (error) {
        message.innerText = "Email ou senha incorretos.";
        message.style.color = "red";
    } else {
        message.innerText = "Login realizado com sucesso!";
        message.style.color = "green";

        setTimeout(() => {
            window.location.href = "dashboard.html";
        }, 1000);
    }
});

</script>

</body>
</html>
